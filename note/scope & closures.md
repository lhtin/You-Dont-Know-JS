# 作用域与闭包

## 编译器工作原理

1. 通过 Tokenizing/Lexing 过程得到 **tokens**
2. 通过 Parsing 过程得到 **AST**
3. 通过 Code-Generation 过程得到 **executable code**，包括给硬件运行的机器码、给虚拟机运行的字节码

一般将第1和2步称为编译器的前端，第3步称为编译器的后端。

几乎所有编程语言都有**在变量中存储值**的能力。

作用域：引擎根据名称寻找变量的一套规则。

JS中作用域机制：

1. 首先编译过程会创建每一层的作用域，并往作用域中添加本作用域声明的变量。
2. 执行过程中会遇到两种情况：1. 查找某个变量的值(RHS)；2. 给某个变量赋值(LHS)。
3. 遇到第1种情况时，会从当前作用域开始往外层作用域寻找变量的值，假如到最外层还没有找到就会报ReferenceError错误。
4. 遇到第2种情况时，如果找不到，在非严格模式下会在最外层作用域创建该变量，严格模式下会报ReferenceError错误。